package com.toozo.asteriumwebserver.gamelogic.items.equipment;

import java.util.Collection;
import java.util.Map;
import java.util.concurrent.ConcurrentHashMap;

import com.toozo.asteriumwebserver.gamelogic.PlayerCharacter;

/**
 * A player's equipment, with slots for each type of {@link AbstractEquipmentItem}.
 * 
 * @author Greg Schmitt
 */
public class Equipment {
	// ===== FIELDS =====
	private Map<EquipmentSlot, AbstractEquipmentItem> slots;
	// ==================
	
	// ===== CONSTRUCTORS =====
	public Equipment() {
	}
	
	public Equipment(AbstractEquipmentItem starterItem) {
		
	}
	
	/**
	 * Constructs a new Equipment with as many of the {@link AbstractEquipmentItem}s in
	 * starterItems equipped as possible.
	 * 
	 * If multiple items are of the same type (e.g. two headgear items), there is no guarantee
	 * which will be equipped.
	 * 
	 * @param starterItems a list of items which should be equipped if possible.
	 */
	public Equipment(Collection<AbstractEquipmentItem> starterItems) {
		this.slots = new ConcurrentHashMap<EquipmentSlot, AbstractEquipmentItem>();
		
		// Instantiate slots
		for (EquipmentSlot slot : EquipmentSlot.values()) {
			this.slots.put(slot, null);
		}
		
		// Put items into slots
		EquipmentSlot type;
		for (AbstractEquipmentItem item : starterItems) {
			type = item.getType();
			boolean canEquip = !slotFull(type);
			item.setEquipped(canEquip);
			if (canEquip) {
				// Equip it
				this.slots.put(type, item);
			}
		}
	}
	// ========================
	
	// ===== GETTERS =====
	/**
	 * @param slot The {@link EquipmentSlot} to be checked.
	 * @return True if the equipmentSlot is already occupied, false otherwise.
	 */
	public boolean slotFull(EquipmentSlot slot) {
		return this.slots.get(slot) == null;
	}
	
	/**
	 * @param slot The {@link EquipmentSlot} to be checked.
	 * @return True if the equipmentSlot is unoccupied, false otherwise.
	 */
	public boolean slotEmpty(EquipmentSlot slot) {
		return !slotFull(slot);
	}
	// ===================
	
	// ===== SETTERS =====
	/**
	 * If equipper has  item, equips item to the appropriate slot.
	 * If equipper already has an equipment item in that slot, swaps them.
	 * 
	 * @param item The item to be equipped.
	 * @param equipper The {@link PlayerCharacter} who is equipping this item.
	 */
	public void equip(AbstractEquipmentItem item, PlayerCharacter equipper) {
		EquipmentSlot type = item.getType();
		// Make sure that equipper has the item.
		if (equipper.getInventory().contains(item)) {
			
		}
	}
	// ===================
}
